stages:
  - test

test:
  stage: test
  image: php:8.1-apache
  script:
    - echo "ğŸš€ Test PHP simple"
    - php --version
    - ls -la
    
    # Test extensions PHP
    - |
      php -r '
      echo "=== RÃ‰SULTATS TESTS ===\n";
      echo "PHP Version: " . phpversion() . "\n";
      echo "Extensions MySQL:\n";
      echo "- mysqli: " . (extension_loaded("mysqli") ? "âœ… OK" : "âŒ MANQUANT") . "\n";
      echo "- pdo_mysql: " . (extension_loaded("pdo_mysql") ? "âœ… OK" : "âŒ MANQUANT") . "\n";
      echo "- pdo: " . (extension_loaded("pdo") ? "âœ… OK" : "âŒ MANQUANT") . "\n";
      
      if(extension_loaded("mysqli") && extension_loaded("pdo_mysql")) {
        echo "\nğŸ‰ Votre application PHP/MySQL est prÃªte pour GitLab CI/CD!\n";
      } else {
        echo "\nâš ï¸ Certaines extensions MySQL sont manquantes\n";
      }
      '
    
    - echo "âœ… Pipeline exÃ©cutÃ© avec succÃ¨s!"
  only:
    - main